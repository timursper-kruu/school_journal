"use strict";let body=document.querySelector("article");let bodyInner=body.innerHTML.replace(/<a .+?>/g,"").replace(/<\/a>/g,"");let scole=JSON.parse(bodyInner);let title=document.createElement("title");title.textContent=`Журнал группы ВД`;document.head.prepend(title);let stl=document.createElement("style");stl.textContent=`\n   @page {size: A4 portrait; margin:1.5cm 2.5cm}\n   body {width:16cm; margin:auto; font:10pt Arial, sans-serif; text-align:center}\n   nav {text-align:center; margin-bottom:6pt; page-break-before:always}\n   h1, h2, h3, p {text-align:center;}\n   h1 {font-size:18pt; margin:192pt 0pt 0pt}\n   h2 {font-size:12pt; margin:36pt 0pt 12pt}\n   h2:first-of-type {font-size:10pt; margin:72pt 0pt 0pt}\n   h3 {font-size:12pt; margin:0pt 0pt 12pt}\n   p {margin:48pt 0pt; border-top:0.25pt solid black}\n   button {position:fixed; top:5px; right:20px; font-size:24pt; display:none;}\n   \n   /* Последняя страница */\n   aside {width:10cm; margin:auto; padding-top:5cm; page-break-before:always}\n   aside p {border:none}\n   aside p:nth-child(2) {border-top:0.25pt solid black}\n   aside p:nth-child(3) {text-align:left; font-style:italic}\n   \n   /* Таблица с отметками */\n   .pupCol, .gradeCol {\n      display:inline-block; width:3.5cm; border-top:0.25pt solid black;}\n   .gradeCol {width:1.1cm;}\n   .pupCol div, .gradeCol div {\n      border-bottom:0.25pt solid black; padding:1pt 0pt; text-align:left;}\n   .gradeCol div {text-align:center; border-left:0.25pt solid black;}\n   .gradeCol div:first-child {font-stretch:condensed}\n   \n   /* Таблица с темами */\n   .topicsStr {border:0.25pt solid black; border-style:none none solid}\n   .ctr {border-top:0.25pt solid black}\n   .topicsStr div {\n      display:inline-block; padding:3pt; text-align:center; vertical-align:top;\n      -webkit-hyphens:auto; -moz-hyphens:auto; -ms-hyphens:auto; hiphens:auto;}\n   .topicsStr div:nth-child(1) {width:1cm; border-left:none}\n   .topicsStr div:nth-child(2) {width:0.6cm}\n   .topicsStr div:nth-child(3) {width:0.8cm}\n   .topicsStr div:nth-child(4) {width:6.4cm; text-align:left}\n   .topicsStr div:nth-child(5) {width:6cm; text-align:left}\n   .ctr div:nth-child(3), .ctr div:nth-child(4), .ctr div:nth-child(5) {\n      text-align:center;}\n   h3 + .topicsStr div {border-left:0.25pt solid black}\n   h3 + .topicsStr div:first-child {border-left:none}\n   \n   @media screen {\n      html {background:#ccc}\n      body {background:white; margin:2cm auto; padding-top:1cm;}\n      nav, aside {padding-top:12pt; border-top:5px groove #ccc; margin-top:24pt}\n      aside {padding:12pt 3cm 2cm}\n      button {display:block;}\n   }\n`;document.head.prepend(stl);let doc=`\n   <button type="button" onClick="window.print()" title="Печать"\n      >&#128424;</button>\n   <p><small>(наименование образовательной организации)</small></p>\n   <h1>Журнал группы внеурочной деятельности<br style="margin-bottom:12pt">\n   <small>Группа ${grFull.replace("(","<br>(").replace(": ","<br>")}</small></h1>\n   <h2>20_____/_____ учебный год</h2>`;let pageNum=2;let pupCol="<div class='pupCol'><div>&nbsp;</div>";for(let pupil of scole.pnList){pupil=pupil.replace(/\|.*\|/,"").trim();pupCol+=`<div>${pupil}</div>`}pupCol+="</div>";let currPageLeft="",currPageRight="";let lessNum=0;for(let dt in scole){if(dt=="pnList")continue;if(!(lessNum%11)){doc+=currPageLeft+currPageRight;currPageLeft=`<nav>${pageNum}</nav>`;pageNum++;currPageLeft+=pupCol;currPageRight=`<nav>${pageNum}</nav>`;pageNum++;currPageRight+="<div class='topicsStr ctr'>"+"<div>Дата</div><div>ч</div><div>Вес</div>"+"<div>Содержание занятия</div><div>Задание на дом</div>"+"</div>"}if(scole[dt].w!=9){currPageLeft+=`<div class='gradeCol'><div>${dt}</div>`;for(let gr of scole[dt].g){gr=gr.replace("999","зач");if(!/\d{2}\.\d{2}/.test(dt))gr=gr.replace("0","н/а");currPageLeft+=`<div>${gr?gr:" "}</div>`}currPageLeft+="</div>"}if(scole[dt].t){let vol=scole[dt].v?scole[dt].v:1,cursiv=scole[dt].w==9?" style='font-style:italic'":"",weight=scole[dt].w==9?"":scole[dt].w/2,topic=scole[dt].t.substr(0,120),htask=scole[dt].h.substr(0,120);currPageRight+=`<div class='topicsStr'><div>${dt}</div>`+`<div>${vol}</div><div>${weight}</div>`+`<div${cursiv}>${topic}</div><div>${htask}</div></div>`}lessNum++}doc+=currPageLeft+currPageRight;doc+="<aside><p>В настоящем журнале пронумеровано,<br>"+"прошнуровано и скреплено печатью</p><p>листов</p><p>Подпись:</p></aside>";document.body.innerHTML=doc;